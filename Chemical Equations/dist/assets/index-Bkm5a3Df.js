import{H,M as q,P as I,T as K,c as Q}from"./index-BWB3efZv.js";function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t,n){L(e,t),t.set(e,n)}function L(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function E(e,t){var n=O(e,t,"get");return $(e,n)}function $(e,t){return t.get?t.get.call(e):t.value}function C(e,t,n){var p=O(e,t,"set");return N(e,p,n),n}function O(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function N(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var y=new WeakMap;class Y{constructor(){F(this,y,{writable:!0,value:void 0}),D(this,"register",t=>{E(this,y).push(t)}),D(this,"unregister",t=>{let n;for(;(n=E(this,y).indexOf(t))!==-1;)E(this,y).splice(n,1)}),D(this,"backendChanged",t=>{for(const n of E(this,y))n.backendChanged(t)}),C(this,y,[])}}function h(e,t,n){A(e,t),t.set(e,n)}function A(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=B(e,t,"get");return G(e,n)}function G(e,t){return t.get?t.get.call(e):t.value}function m(e,t,n){var p=B(e,t,"set");return J(e,p,n),n}function B(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function J(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}var c=new WeakMap,_=new WeakMap,u=new WeakMap,w=new WeakMap,b=new WeakMap,x=new WeakMap,M=new WeakMap,W=new WeakMap,P=new WeakMap,S=new WeakMap,T=new WeakMap;class k{constructor(t,n,p){if(h(this,c,{writable:!0,value:void 0}),h(this,_,{writable:!0,value:void 0}),h(this,u,{writable:!0,value:void 0}),h(this,w,{writable:!0,value:void 0}),h(this,b,{writable:!0,value:void 0}),h(this,x,{writable:!0,value:(a,r,s)=>{var o,d;if(!s.backend)throw new Error("You must specify a 'backend' property in your Backend entry: ".concat(JSON.stringify(s)));const f=s.backend(a,r,s.options);let v=s.id;const g=!s.id&&f&&f.constructor;if(g&&(v=f.constructor.name),v)g&&console.warn(`Deprecation notice: You are using a pipeline which doesn't include backends' 'id'.
        This might be unsupported in the future, please specify 'id' explicitely for every backend.`);else throw new Error("You must specify an 'id' property in your Backend entry: ".concat(JSON.stringify(s),`
        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-5xx`));if(i(this,u)[v])throw new Error(`You must specify a unique 'id' property in your Backend entry:
        `.concat(JSON.stringify(s)," (conflicts with: ").concat(JSON.stringify(i(this,u)[v]),")"));return{id:v,instance:f,preview:(o=s.preview)!==null&&o!==void 0?o:!1,transition:s.transition,skipDispatchOnTransition:(d=s.skipDispatchOnTransition)!==null&&d!==void 0?d:!1}}}),l(this,"setup",()=>{if(!(typeof window>"u")){if(k.isSetUp)throw new Error("Cannot have two MultiBackends at the same time.");k.isSetUp=!0,i(this,M).call(this,window),i(this,u)[i(this,c)].instance.setup()}}),l(this,"teardown",()=>{typeof window>"u"||(k.isSetUp=!1,i(this,W).call(this,window),i(this,u)[i(this,c)].instance.teardown())}),l(this,"connectDragSource",(a,r,s)=>i(this,T).call(this,"connectDragSource",a,r,s)),l(this,"connectDragPreview",(a,r,s)=>i(this,T).call(this,"connectDragPreview",a,r,s)),l(this,"connectDropTarget",(a,r,s)=>i(this,T).call(this,"connectDropTarget",a,r,s)),l(this,"profile",()=>i(this,u)[i(this,c)].instance.profile()),l(this,"previewEnabled",()=>i(this,u)[i(this,c)].preview),l(this,"previewsList",()=>i(this,_)),l(this,"backendsList",()=>i(this,w)),h(this,M,{writable:!0,value:a=>{i(this,w).forEach(r=>{r.transition&&a.addEventListener(r.transition.event,i(this,P))})}}),h(this,W,{writable:!0,value:a=>{i(this,w).forEach(r=>{r.transition&&a.removeEventListener(r.transition.event,i(this,P))})}}),h(this,P,{writable:!0,value:a=>{const r=i(this,c);if(i(this,w).some(o=>o.id!==i(this,c)&&o.transition&&o.transition.check(a)?(m(this,c,o.id),!0):!1),i(this,c)!==r){var s;i(this,u)[r].instance.teardown(),Object.keys(i(this,b)).forEach(v=>{const g=i(this,b)[v];g.unsubscribe(),g.unsubscribe=i(this,S).call(this,g.func,...g.args)}),i(this,_).backendChanged(this);const o=i(this,u)[i(this,c)];if(o.instance.setup(),o.skipDispatchOnTransition)return;const d=a.constructor,f=new d(a.type,a);(s=a.target)===null||s===void 0||s.dispatchEvent(f)}}}),h(this,S,{writable:!0,value:(a,r,s,o)=>i(this,u)[i(this,c)].instance[a](r,s,o)}),h(this,T,{writable:!0,value:(a,r,s,o)=>{const d="".concat(a,"_").concat(r),f=i(this,S).call(this,a,r,s,o);return i(this,b)[d]={func:a,args:[r,s,o],unsubscribe:f},()=>{i(this,b)[d].unsubscribe(),delete i(this,b)[d]}}}),!p||!p.backends||p.backends.length<1)throw new Error(`You must specify at least one Backend, if you are coming from 2.x.x (or don't understand this error)
        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-2xx`);m(this,_,new Y),m(this,u,{}),m(this,w,[]),p.backends.forEach(a=>{const r=i(this,x).call(this,t,n,a);i(this,u)[r.id]=r,i(this,w).push(r)}),m(this,c,i(this,w)[0].id),m(this,b,{})}}l(k,"isSetUp",!1);const U=(e,t,n)=>new k(e,t,n);export{H as HTML5DragTransition,q as MouseTransition,U as MultiBackend,I as PointerTransition,K as TouchTransition,Q as createTransition};
